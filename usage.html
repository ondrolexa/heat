

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Usage &mdash; Heatlib 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="heatlib" href="modules.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Heatlib
          

          
          </a>

          
            
            
              <div class="version">
                0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">Heatlib module</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#simple-examples">Simple examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example-for-domain-with-constant-physical-properties">Example for domain with constant physical properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-for-domain-with-variable-physical-properties-and-grid-size">Example for domain with variable physical properties and grid size</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#additional-solvers">Additional solvers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#deformation">Deformation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#erosion">Erosion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#simulations">Simulations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#assembly-simulation">Assembly simulation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#user-defined-solvers">User-defined solvers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tracking-p-t-t-evolution-with-tracer">Tracking P-T-t evolution with tracer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hints">Hints</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">heatlib</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Heatlib</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Usage</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/usage.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h1>
<p>To use this library you have to import it.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">heatlib</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<div class="section" id="simple-examples">
<h2>Simple examples<a class="headerlink" href="#simple-examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="example-for-domain-with-constant-physical-properties">
<h3>Example for domain with constant physical properties<a class="headerlink" href="#example-for-domain-with-constant-physical-properties" title="Permalink to this headline">¶</a></h3>
<p>Lets create model for crustal (35 km) geotherm with 100m resolution,
1e-6 heat production and default other crustal properties… <code class="docutils literal notranslate"><span class="pre">plot_unit</span></code>
argument allows change plotting spatial units.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d_c</span> <span class="o">=</span> <span class="n">Domain_Constant_1D</span><span class="p">(</span><span class="n">L</span><span class="o">=</span><span class="n">Length</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="s1">&#39;km&#39;</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span> <span class="n">H</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">plot_unit</span><span class="o">=</span><span class="s1">&#39;km&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we need to define boundary conditions. We will use <code class="docutils literal notranslate"><span class="pre">Dirichlet_BC</span></code>
at top and <code class="docutils literal notranslate"><span class="pre">Neumann_BC</span></code> with 32mW/m2 at bottom.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tbc</span> <span class="o">=</span> <span class="n">Dirichlet_BC</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">bbc</span> <span class="o">=</span> <span class="n">Neumann_BC</span><span class="p">(</span><span class="o">-</span><span class="mf">0.032</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we can create <code class="docutils literal notranslate"><span class="pre">Model_Constant_1D</span></code> instance to assemble domain and
BCs… <code class="docutils literal notranslate"><span class="pre">time_unit</span></code> argument allows change plotting time units.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m_c</span> <span class="o">=</span> <span class="n">Model_Constant_1D</span><span class="p">(</span><span class="n">d_c</span><span class="p">,</span> <span class="n">tbc</span><span class="p">,</span> <span class="n">bbc</span><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, we can setup solvers we will use for modelling</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">init_c</span> <span class="o">=</span> <span class="n">SteadyState_Constant_1D</span><span class="p">()</span>
<span class="n">intrusion_c</span> <span class="o">=</span> <span class="n">SetTemperature_1D</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">15000</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">700</span><span class="p">)</span>
<span class="n">small_step_c</span> <span class="o">=</span> <span class="n">BTCS_Constant_1D</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="n">Time</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="n">big_step_c</span> <span class="o">=</span> <span class="n">BTCS_Constant_1D</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="n">Time</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">steps</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>We will use two solvers to calculate initial state…</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m_c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">init_c</span><span class="p">)</span>
<span class="n">m_c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">intrusion_c</span><span class="p">)</span>
<span class="n">m_c</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/output_12_0.png" src="_images/output_12_0.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m_c</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dirichlet</span> <span class="n">BC</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Domain</span> <span class="n">size</span><span class="p">:</span> <span class="mf">35000.0</span> <span class="k">with</span> <span class="mi">350</span> <span class="n">nodes</span><span class="o">.</span>
<span class="n">k</span><span class="o">=</span><span class="mf">2.5</span> <span class="n">H</span><span class="o">=</span><span class="mf">1e-06</span> <span class="n">rho</span><span class="o">=</span><span class="mi">2700</span> <span class="n">c</span><span class="o">=</span><span class="mi">900</span>
<span class="n">Neumann</span> <span class="n">BC</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.032</span>
</pre></div>
</div>
<p>Once initial state is ready, we can use evolutionary solver to solve
evolutionary equation… Note, that time step is defined in solver.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m_c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">small_step_c</span><span class="p">)</span>
<span class="n">m_c</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/output_15_0.png" src="_images/output_15_0.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m_c</span><span class="o">.</span><span class="n">get_T</span><span class="p">(</span><span class="n">Length</span><span class="p">(</span><span class="mf">12.5</span><span class="p">,</span> <span class="s1">&#39;km&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">699.2665798968195</span>
</pre></div>
</div>
<p>To calculate evolutionary solution for more time steps, we can use
solver instantiated with <code class="docutils literal notranslate"><span class="pre">steps</span></code> argument.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m_c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">big_step_c</span><span class="p">)</span>
<span class="n">m_c</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/output_18_0.png" src="_images/output_18_0.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m_c</span><span class="o">.</span><span class="n">get_T</span><span class="p">(</span><span class="n">Length</span><span class="p">(</span><span class="mf">12.5</span><span class="p">,</span> <span class="s1">&#39;km&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">488.2480815751985</span>
</pre></div>
</div>
</div>
<div class="section" id="example-for-domain-with-variable-physical-properties-and-grid-size">
<h3>Example for domain with variable physical properties and grid size<a class="headerlink" href="#example-for-domain-with-variable-physical-properties-and-grid-size" title="Permalink to this headline">¶</a></h3>
<p>Lets create model for crustal geotherm with several layers…</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">uc_sed</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s1">&#39;UCS&#39;</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">3.2</span><span class="p">,</span> <span class="n">H</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">rho</span><span class="o">=</span><span class="mi">2350</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">uc_base</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s1">&#39;UCB&#39;</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">H</span><span class="o">=</span><span class="mf">3e-6</span><span class="p">,</span> <span class="n">rho</span><span class="o">=</span><span class="mi">2700</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">900</span><span class="p">)</span>
<span class="n">mc</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s1">&#39;MC&#39;</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">2.3</span><span class="p">,</span> <span class="n">H</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">rho</span><span class="o">=</span><span class="mi">2800</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">800</span><span class="p">)</span>
<span class="n">lc_felsic</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s1">&#39;LCF&#39;</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">rho</span><span class="o">=</span><span class="mi">2900</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">750</span><span class="p">)</span>
<span class="n">lc_mafic</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s1">&#39;LCM&#39;</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">rho</span><span class="o">=</span><span class="mi">3200</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">700</span><span class="p">)</span>
</pre></div>
</div>
<p>To create domain, we need to provide list of elements to define domain
geometry… We can use multilication and addition of elements to assemble
it</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">geom</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="n">uc_sed</span> <span class="o">+</span> <span class="mi">50</span><span class="o">*</span><span class="n">uc_base</span> <span class="o">+</span> <span class="mi">100</span><span class="o">*</span><span class="n">mc</span> <span class="o">+</span> <span class="mi">100</span><span class="o">*</span><span class="n">lc_felsic</span> <span class="o">+</span> <span class="mi">100</span><span class="o">*</span><span class="n">lc_mafic</span>
<span class="n">d_v</span> <span class="o">=</span> <span class="n">Domain_Variable_1D</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="n">plot_unit</span><span class="o">=</span><span class="s1">&#39;km&#39;</span><span class="p">)</span>
<span class="n">d_v</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Domain_Variable_1D</span><span class="p">:</span> <span class="p">(</span><span class="mi">450</span> <span class="n">elements</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">show</span></code> method of could be used to visualize domain and property</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d_v</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/output_25_0.png" src="_images/output_25_0.png" />
<p>Now we can create <code class="docutils literal notranslate"><span class="pre">Model_Variable_1D</span></code> instance to assemble domain and
BCs…</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m_v</span> <span class="o">=</span> <span class="n">Model_Variable_1D</span><span class="p">(</span><span class="n">d_v</span><span class="p">,</span> <span class="n">tbc</span><span class="p">,</span> <span class="n">bbc</span><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, we can setup solvers we will use for modelling</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">init_v</span> <span class="o">=</span> <span class="n">SteadyState_Variable_1D</span><span class="p">()</span>
<span class="n">intrusion_v</span> <span class="o">=</span> <span class="n">SetTemperature_1D</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">15000</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">700</span><span class="p">)</span>
<span class="n">small_step_v</span> <span class="o">=</span> <span class="n">BTCS_Variable_1D</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="n">Time</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="n">big_step_v</span> <span class="o">=</span> <span class="n">BTCS_Variable_1D</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="n">Time</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">steps</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>We will use two solvers to calculate initial state…</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m_v</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">init_v</span><span class="p">)</span>
<span class="n">m_v</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">intrusion_v</span><span class="p">)</span>
<span class="n">m_v</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/output_31_0.png" src="_images/output_31_0.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m_v</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dirichlet</span> <span class="n">BC</span><span class="p">:</span> <span class="mi">0</span>
<span class="mf">2500.0</span> <span class="mi">100</span> <span class="n">UCS</span><span class="p">:</span> <span class="n">k</span><span class="o">=</span><span class="mf">3.2</span>  <span class="n">H</span><span class="o">=</span><span class="mf">1e-06</span>  <span class="n">rho</span><span class="o">=</span><span class="mi">2350</span>  <span class="n">c</span><span class="o">=</span><span class="mi">1000</span>
<span class="mf">2500.0</span> <span class="mi">50</span> <span class="n">UCB</span><span class="p">:</span> <span class="n">k</span><span class="o">=</span><span class="mf">2.5</span>  <span class="n">H</span><span class="o">=</span><span class="mf">3e-06</span>  <span class="n">rho</span><span class="o">=</span><span class="mi">2700</span>  <span class="n">c</span><span class="o">=</span><span class="mi">900</span>
<span class="mf">10000.0</span> <span class="mi">100</span> <span class="n">MC</span><span class="p">:</span> <span class="n">k</span><span class="o">=</span><span class="mf">2.3</span>  <span class="n">H</span><span class="o">=</span><span class="mf">1e-06</span>  <span class="n">rho</span><span class="o">=</span><span class="mi">2800</span>  <span class="n">c</span><span class="o">=</span><span class="mi">800</span>
<span class="mf">10000.0</span> <span class="mi">100</span> <span class="n">LCF</span><span class="p">:</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span>  <span class="n">H</span><span class="o">=</span><span class="mi">0</span>  <span class="n">rho</span><span class="o">=</span><span class="mi">2900</span>  <span class="n">c</span><span class="o">=</span><span class="mi">750</span>
<span class="mf">10000.0</span> <span class="mi">100</span> <span class="n">LCM</span><span class="p">:</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span>  <span class="n">H</span><span class="o">=</span><span class="mi">0</span>  <span class="n">rho</span><span class="o">=</span><span class="mi">3200</span>  <span class="n">c</span><span class="o">=</span><span class="mi">700</span>
<span class="n">Neumann</span> <span class="n">BC</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.032</span>
</pre></div>
</div>
<p>Once initial state is ready, we can use evolutionary solver to solve
evolutionary equation… Remember that time step is defined in solver and
units of time step are defined by <code class="docutils literal notranslate"><span class="pre">t_units</span></code> property of model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m_v</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">small_step_v</span><span class="p">)</span>
<span class="n">m_v</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/output_34_0.png" src="_images/output_34_0.png" />
<p>To calculate evolutionary solution for more time steps, we can use
solver instantiated with <code class="docutils literal notranslate"><span class="pre">step</span></code> argument.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m_v</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">big_step_v</span><span class="p">)</span>
<span class="n">m_v</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/output_36_0.png" src="_images/output_36_0.png" />
</div>
</div>
<div class="section" id="additional-solvers">
<h2>Additional solvers<a class="headerlink" href="#additional-solvers" title="Permalink to this headline">¶</a></h2>
<div class="section" id="deformation">
<h3>Deformation<a class="headerlink" href="#deformation" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Deform_Constant_1D</span></code> solver allows to strech computational domain
instantaneosly by given <code class="docutils literal notranslate"><span class="pre">factor</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d_c</span> <span class="o">=</span> <span class="n">Domain_Constant_1D</span><span class="p">(</span><span class="n">L</span><span class="o">=</span><span class="mi">35000</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span> <span class="n">H</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">plot_unit</span><span class="o">=</span><span class="s1">&#39;km&#39;</span><span class="p">)</span>
<span class="n">m_c</span> <span class="o">=</span> <span class="n">Model_Constant_1D</span><span class="p">(</span><span class="n">d_c</span><span class="p">,</span> <span class="n">tbc</span><span class="p">,</span> <span class="n">bbc</span><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;Ma&#39;</span><span class="p">)</span>
<span class="n">calc_dt</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">edot</span> <span class="o">=</span> <span class="mf">3e-15</span>
<span class="n">stretch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">edot</span> <span class="o">*</span> <span class="n">calc_dt</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">))</span>
<span class="n">deform_c</span> <span class="o">=</span> <span class="n">Deform_Constant_1D</span><span class="p">(</span><span class="n">factor</span><span class="o">=</span><span class="n">stretch</span><span class="p">)</span>
<span class="n">btcs_c</span> <span class="o">=</span> <span class="n">BTCS_Constant_1D</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="n">calc_dt</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">Simulation_1D</span><span class="p">(</span><span class="n">m_c</span><span class="p">,</span> <span class="n">init_c</span><span class="p">,</span> <span class="mi">50</span><span class="o">*</span><span class="p">[</span><span class="n">deform_c</span><span class="p">,</span> <span class="n">btcs_c</span><span class="p">],</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Done</span><span class="o">.</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
<img alt="_images/output_49_0.png" src="_images/output_49_0.png" />
</div>
<div class="section" id="erosion">
<h3>Erosion<a class="headerlink" href="#erosion" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Shift_Constant_1D</span></code> solver allows to extend/trim domain by given
<code class="docutils literal notranslate"><span class="pre">amount</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d_c</span> <span class="o">=</span> <span class="n">Domain_Constant_1D</span><span class="p">(</span><span class="n">L</span><span class="o">=</span><span class="mi">35000</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span> <span class="n">H</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">plot_unit</span><span class="o">=</span><span class="s1">&#39;km&#39;</span><span class="p">)</span>
<span class="n">m_c</span> <span class="o">=</span> <span class="n">Model_Constant_1D</span><span class="p">(</span><span class="n">d_c</span><span class="p">,</span> <span class="n">tbc</span><span class="p">,</span> <span class="n">bbc</span><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;Ma&#39;</span><span class="p">)</span>
<span class="n">calc_dt</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">erosion_vel</span> <span class="o">=</span> <span class="n">Length</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;cm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">Time</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">erode</span> <span class="o">=</span> <span class="n">erosion_vel</span> <span class="o">*</span> <span class="n">calc_dt</span>
<span class="n">erosion_c</span> <span class="o">=</span> <span class="n">Shift_Constant_1D</span><span class="p">(</span><span class="n">amount</span><span class="o">=-</span><span class="n">erode</span><span class="p">)</span>
<span class="n">btcs_c</span> <span class="o">=</span> <span class="n">BTCS_Constant_1D</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="n">calc_dt</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">Simulation_1D</span><span class="p">(</span><span class="n">m_c</span><span class="p">,</span> <span class="p">[</span><span class="n">init_c</span><span class="p">,</span> <span class="n">intrusion_c</span><span class="p">],</span> <span class="mi">20</span><span class="o">*</span><span class="p">[</span><span class="n">erosion_c</span><span class="p">,</span> <span class="n">btcs_c</span><span class="p">],</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Done</span><span class="o">.</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
<img alt="_images/output_54_0.png" src="_images/output_54_0.png" />
</div>
</div>
<div class="section" id="simulations">
<h2>Simulations<a class="headerlink" href="#simulations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="assembly-simulation">
<h3>Assembly simulation<a class="headerlink" href="#assembly-simulation" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Simulation_1D</span></code> class allows you to automatize the model calculation,
store model results and could be used for model post-processing.</p>
<p>We will use model used in previous example and we will define solvers…</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">init_v</span> <span class="o">=</span> <span class="n">SteadyState_Variable_1D</span><span class="p">()</span>
<span class="n">intrusion_v</span> <span class="o">=</span> <span class="n">SetTemperature_1D</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="n">Length</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="s1">&#39;km&#39;</span><span class="p">),</span>
                                <span class="n">xmax</span><span class="o">=</span><span class="n">Length</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;km&#39;</span><span class="p">),</span>
                                <span class="n">value</span><span class="o">=</span><span class="mi">700</span><span class="p">)</span>
<span class="n">diffuse_v</span> <span class="o">=</span> <span class="n">BTCS_Variable_1D</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="n">Time</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">steps</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>To define simulation, we will provide the model, solvers or lists of
solvers used to calculate initial state and evolutionary solution. The
number of simulation cycles to be calculated could be specified by
keyword argument <code class="docutils literal notranslate"><span class="pre">repeat</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">init_solvers</span> <span class="o">=</span> <span class="p">[</span><span class="n">init_v</span><span class="p">]</span>
<span class="n">simulation_solvers</span> <span class="o">=</span> <span class="p">[</span><span class="n">intrusion_v</span><span class="p">,</span> <span class="n">diffuse_v</span><span class="p">]</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">Simulation_1D</span><span class="p">(</span><span class="n">m_v</span><span class="p">,</span> <span class="n">init_solvers</span><span class="p">,</span> <span class="n">simulation_solvers</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>Once the simulation is created we can run model…</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Done</span><span class="o">.</span>
</pre></div>
</div>
<p>Now we can plot results</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m_v</span><span class="o">.</span><span class="n">time_unit</span> <span class="o">=</span> <span class="s1">&#39;Ma&#39;</span>
<span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
<img alt="_images/output_44_0.png" src="_images/output_44_0.png" />
</div>
</div>
<div class="section" id="user-defined-solvers">
<h2>User-defined solvers<a class="headerlink" href="#user-defined-solvers" title="Permalink to this headline">¶</a></h2>
<div class="section" id="tracking-p-t-t-evolution-with-tracer">
<h3>Tracking P-T-t evolution with tracer<a class="headerlink" href="#tracking-p-t-t-evolution-with-tracer" title="Permalink to this headline">¶</a></h3>
<p>Create program that will track time, temperature and depth evolution of
sample <strong>S</strong> involved in <em>“Naive orogeny”</em> characterized by convergence
with constant strain rate <span class="math notranslate nohighlight">\(\dot{\epsilon}\)</span>, erosion with rate
<span class="math notranslate nohighlight">\(\dot{r}\)</span> dependent on actual topography (which is calculated from
Airy isostasy of thickenned crust) and transient heat conduction for
total time 20 Ma.</p>
<p>We want to trace the depth-temperature evolution of particle initially
located in depth 25km within thermally equilibrated (steady-state geotherm)
crust with initial thickness 35km and plot results.</p>
<img alt="_images/naiveorogen.png" src="_images/naiveorogen.png" />
<p>Convergence strain rate:</p>
<div class="math notranslate nohighlight">
\[\dot{\epsilon} = 3\cdot 10^{-15}~m\cdot s^{-1}\]</div>
<p>Erosion rate:</p>
<div class="math notranslate nohighlight">
\[\dot{r}(h) = \dot{\epsilon}\cdot\exp\left(K_e\cdot\left[\frac{E_t(h)}{E_t(h_{max})}-1\right]\right)\]</div>
<p>Topography:</p>
<div class="math notranslate nohighlight">
\[E_t(h) = \frac{(h - h_0)(\rho_m-\rho_c)}{\rho_m}\]</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 48%" />
<col style="width: 29%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>property</p></th>
<th class="head"><p>symbol</p></th>
<th class="head"><p>value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Crust density</p></td>
<td><p><span class="math notranslate nohighlight">\(\rho_c\)</span></p></td>
<td><p>2800 kg/m3</p></td>
</tr>
<tr class="row-odd"><td><p>Mantle density</p></td>
<td><p><span class="math notranslate nohighlight">\(\rho_m\)</span></p></td>
<td><p>3200 kg/m3</p></td>
</tr>
<tr class="row-even"><td><p>Thermal conductivity</p></td>
<td><p><span class="math notranslate nohighlight">\(\lambda\)</span></p></td>
<td><p>2.5 W/(m⋅K)</p></td>
</tr>
<tr class="row-odd"><td><p>Specific heat capacity</p></td>
<td><p><span class="math notranslate nohighlight">\(c\)</span></p></td>
<td><p>900 J/(kg.K)</p></td>
</tr>
<tr class="row-even"><td><p>Heat production</p></td>
<td><p><span class="math notranslate nohighlight">\(H\)</span></p></td>
<td><p>1e-6 W/m3</p></td>
</tr>
<tr class="row-odd"><td><p>Surface temperature</p></td>
<td><p><span class="math notranslate nohighlight">\(T_0\)</span></p></td>
<td><p>0°C</p></td>
</tr>
<tr class="row-even"><td><p>MOHO heat flow</p></td>
<td><p><span class="math notranslate nohighlight">\(q_m\)</span></p></td>
<td><p>0.025 W/m2</p></td>
</tr>
<tr class="row-odd"><td><p>Erosion coefficient</p></td>
<td><p><span class="math notranslate nohighlight">\(K_e\)</span></p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p>Maximum crustal thickness</p></td>
<td><p><span class="math notranslate nohighlight">\(h_{max}\)</span></p></td>
<td><p>70 km</p></td>
</tr>
</tbody>
</table>
<div class="section" id="hints">
<h4>Hints<a class="headerlink" href="#hints" title="Permalink to this headline">¶</a></h4>
<p>For each time step <span class="math notranslate nohighlight">\(dt\)</span> deformation increase thickness, so:</p>
<div class="math notranslate nohighlight">
\[h_{def} = h\cdot\exp(\dot \epsilon dt)\]</div>
<p>and erosion decrease thickness, so:</p>
<div class="math notranslate nohighlight">
\[h_{new} = h_{def}\cdot\exp(-\dot r(h_{def}) dt)\]</div>
<p>The amount of erosion for given tie step could be calculated as:</p>
<div class="math notranslate nohighlight">
\[dh = h_{def} - h_{new}\]</div>
<p>To implement new functionality, you can create user-defined solvers,
which could be plugged into simulation. Easiest way is to subclass existing
solvers. The first example is solver based on <cite>Deform_Constant_1D</cite> and
calculate deformation factor from time-step and strain-rate.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyDeformation_Constant_1D</span><span class="p">(</span><span class="n">Deform_Constant_1D</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edot</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># calculate factor based on strain-rate and time</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">edot</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dt</span><span class="p">))</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">factor</span><span class="o">=</span><span class="n">factor</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>Second example shows, how to implement solver, which need to access model properties
during simulation…</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyErosion_Constant_1D</span><span class="p">(</span><span class="n">Shift_Constant_1D</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edot</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">Ke</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">rhoc</span><span class="o">=</span><span class="mi">2800</span><span class="p">,</span> <span class="n">rhom</span><span class="o">=</span><span class="mi">3200</span><span class="p">,</span><span class="n">href</span><span class="o">=</span><span class="mi">35000</span><span class="p">,</span> <span class="n">hmax</span><span class="o">=</span><span class="mi">70000</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
        <span class="c1"># lambdas for Airy topography and erosion rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">topo</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">h</span><span class="p">:</span> <span class="p">((</span><span class="n">h</span> <span class="o">-</span> <span class="n">href</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">rhom</span> <span class="o">-</span> <span class="n">rhoc</span><span class="p">))</span> <span class="o">/</span> <span class="n">rhom</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rdot</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">h</span><span class="p">:</span> <span class="n">edot</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Ke</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topo</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">topo</span><span class="p">(</span><span class="n">hmax</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">tracers</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># calculate amount and call parent solver</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">amount</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">L</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">rdot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">L</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">tracers</span><span class="o">=</span><span class="n">tracers</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d_c</span> <span class="o">=</span> <span class="n">Domain_Constant_1D</span><span class="p">(</span><span class="n">L</span><span class="o">=</span><span class="n">Length</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="s1">&#39;km&#39;</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
                          <span class="n">n</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span> <span class="n">H</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">rho</span><span class="o">=</span><span class="mi">2800</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span> <span class="n">plot_unit</span><span class="o">=</span><span class="s1">&#39;km&#39;</span><span class="p">)</span>
<span class="n">tbc</span> <span class="o">=</span> <span class="n">Dirichlet_BC</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">bbc</span> <span class="o">=</span> <span class="n">Neumann_BC</span><span class="p">(</span><span class="o">-</span><span class="mf">0.025</span><span class="p">)</span>
<span class="n">m_c</span> <span class="o">=</span> <span class="n">Model_Constant_1D</span><span class="p">(</span><span class="n">d_c</span><span class="p">,</span> <span class="n">tbc</span><span class="p">,</span> <span class="n">bbc</span><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;Ma&#39;</span><span class="p">)</span>
<span class="n">edot</span> <span class="o">=</span> <span class="mf">3e-15</span>
<span class="n">calc_dt</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">init_c</span> <span class="o">=</span> <span class="n">SteadyState_Constant_1D</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># store to tracers</span>
<span class="n">deform_c</span> <span class="o">=</span> <span class="n">MyDeformation_Constant_1D</span><span class="p">(</span><span class="n">edot</span><span class="o">=</span><span class="mf">3e-15</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">calc_dt</span><span class="p">)</span>
<span class="n">erosion_c</span> <span class="o">=</span> <span class="n">MyErosion_Constant_1D</span><span class="p">(</span><span class="n">edot</span><span class="o">=</span><span class="mf">3e-15</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">calc_dt</span><span class="p">,</span> <span class="n">rhoc</span><span class="o">=</span><span class="n">d_c</span><span class="o">.</span><span class="n">rho</span><span class="p">)</span>
<span class="n">btcs_c</span> <span class="o">=</span> <span class="n">BTCS_Constant_1D</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="n">calc_dt</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># store to tracers</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">Tracer_1D</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">Length</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;km&#39;</span><span class="p">),</span> <span class="n">plot_unit</span><span class="o">=</span><span class="s1">&#39;km&#39;</span><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;Ma&#39;</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">Simulation_1D</span><span class="p">(</span><span class="n">m_c</span><span class="p">,</span> <span class="n">init_c</span><span class="p">,</span> <span class="mi">400</span><span class="o">*</span><span class="p">[</span><span class="n">deform_c</span><span class="p">,</span> <span class="n">erosion_c</span><span class="p">,</span> <span class="n">btcs_c</span><span class="p">],</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">tracers</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Done</span><span class="o">.</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
<img alt="_images/output_60_0.png" src="_images/output_60_0.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">T_all</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">x_all</span><span class="o">*</span><span class="mi">2750</span><span class="o">*</span><span class="mf">9.81</span><span class="o">/</span><span class="mf">1e5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature [°C]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure [kbar]&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/output_61_0.png" src="_images/output_61_0.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">color1</span> <span class="o">=</span> <span class="s1">&#39;tab:red&#39;</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">time_all</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">x_all</span><span class="o">*</span><span class="mi">2750</span><span class="o">*</span><span class="mf">9.81</span><span class="o">/</span><span class="mf">1e5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Time [</span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">time_unit</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure [kbar]&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">color1</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">color2</span> <span class="o">=</span> <span class="s1">&#39;tab:blue&#39;</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">time_all</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">T_all</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature [°C]&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">color2</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/output_62_0.png" src="_images/output_62_0.png" />
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="modules.html" class="btn btn-neutral float-right" title="heatlib" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Ondrej Lexa.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>